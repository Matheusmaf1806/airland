<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
    />

    <!-- SDK do Malga Checkout -->
    <script
      type="module"
      src="https://unpkg.com/@malga-checkout/core@latest/dist/malga-checkout/malga-checkout.esm.js"
    ></script>

    <title>Exemplo Completo - Malga Checkout (Sandbox)</title>

    <!-- Exemplo de sobrescrita de tema -->
    <style>
      :root {
        /* Cores para o modal, textos, backgrounds etc. */
        --malga-checkout-color-page-background: #f0f2f5;
        --malga-checkout-color-brand-normal: #39bfad;
      }
      body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #f0f2f5;
      }
      main {
        max-width: 600px;
        margin: 50px auto;
        background: #fff;
        padding: 20px;
        border-radius: 8px;
      }
      h1 {
        margin-top: 0;
      }
    </style>
  </head>

  <body>
    <main>
      <h1>Exemplo Completo - Malga Checkout (Sandbox)</h1>

      <!-- Componente Web do Malga Checkout -->
      <malga-checkout
        id="malga-checkout"
        sandbox="true"  <!-- IMPORTANTE: habilita modo de testes (homologação) -->
        public-key="bfabc953-1ea0-45d0-95e4-4968cfe2a00e"
        client-id="4457c178-0f07-4589-ba0e-954e5816fd0f"
        merchant-id="1deb9fd4-8623-4e0e-a317-135008bb3a0a"
      >
      </malga-checkout>
    </main>

    <script>
      // Seleciona o componente <malga-checkout> no DOM
      const malgaCheckout = document.querySelector('malga-checkout');

      // Configuração dos métodos de pagamento (Pix, Boleto, Crédito)
      malgaCheckout.paymentMethods = {
        pix: {
          expiresIn: 600,
          items: [
            {
              id: "123",
              title: "Produto Exemplo - PIX",
              quantity: 1,
              unitPrice: 100, // R$1,00
            },
          ],
        },
        credit: {
          installments: {
            quantity: 1,
            show: true,
          },
          showCreditCard: true,
        },
        boleto: {
          expiresDate: "2025-12-31",
          instructions: "Boleto de teste no ambiente Sandbox",
          interest: {
            days: 1,
            amount: 100,
          },
          fine: {
            days: 2,
            amount: 200,
          },
          items: [
            {
              id: "123",
              title: "Produto Exemplo - Boleto",
              quantity: 1,
              unitPrice: 100,
            },
          ],
        },
      };

      // Configurações de transação - incluir 'customer' para PIX/BOLETO
      malgaCheckout.transactionConfig = {
        statementDescriptor: "Exemplo Malga Checkout Sandbox",
        amount: 100,       // R$1,00 em centavos
        description: "Demonstração do Malga Checkout Sandbox",
        orderId: "pedido-12345",
        currency: "BRL",
        capture: false,
        // Exemplo de dados de cliente
        customer: {
          name: "Cliente de Teste",
          email: "teste@example.com",
          phoneNumber: "+55 11 98765-4321",
          document: {
            type: "CPF",
            number: "12345678901",
            country: "BR",
          },
          address: {
            zipCode: "01001000",
            street: "Av. Exemplo",
            number: "123",
            complement: "Apto 45",
            neighborhood: "Centro",
            city: "São Paulo",
            state: "SP",
            country: "BR",
          },
        },
      };

      // Configurações do diálogo (modal) de status
      malgaCheckout.dialogConfig = {
        show: true,
        actionButtonLabel: "Continuar",
        errorActionButtonLabel: "Tentar novamente",
        successActionButtonLabel: "Continuar",
        successRedirectUrl: "https://www.malga.io/",
        pixFilledProgressBarColor: "#2FAC9B",
        pixEmptyProgressBarColor: "#D8DFF0",
      };

      // Listeners de eventos
      malgaCheckout.addEventListener("paymentSuccess", (event) => {
        console.log("Pagamento concluído com sucesso:", event.detail);
        alert("Pagamento aprovado!");
      });

      malgaCheckout.addEventListener("paymentFailed", (event) => {
        console.log("Falha no pagamento:", event.detail);
        alert("Falha no pagamento: ver console para detalhes.");
      });
    </script>
  </body>
</html>
