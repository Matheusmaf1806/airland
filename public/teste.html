<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
    />

    <!-- Script do Malga Checkout SDK -->
    <script
      type="module"
      src="https://unpkg.com/@malga-checkout/core@latest/dist/malga-checkout/malga-checkout.esm.js"
    ></script>

    <title>Malga Checkout Example (Sandbox)</title>
  </head>
  <body>
    <main>
      <!-- Componente Web do Malga Checkout -->
      <malga-checkout
        id="malga-checkout"
        sandbox="true"  <!-- Ativa ambiente de homologação -->
        public-key="bfabc953-1ea0-45d0-95e4-4968cfe2a00e"
        client-id="4457c178-0f07-4589-ba0e-954e5816fd0f"
        merchant-id="1deb9fd4-8623-4e0e-a317-135008bb3a0a"
      >
      </malga-checkout>
    </main>

    <script>
      // Seleciona o componente <malga-checkout> no DOM
      const malgaCheckout = document.querySelector('malga-checkout');

      // Configuração dos métodos de pagamento
      malgaCheckout.paymentMethods = {
        pix: {
          expiresIn: 600,
          items: [
            {
              id: "123",
              title: "Produto Exemplo - PIX",
              quantity: 1,
              unitPrice: 159000, // R$ 1.590,00 em centavos
            },
          ],
        },
        credit: {
          installments: {
            quantity: 10, // até 10 parcelas
            show: true,
          },
          showCreditCard: true,
        },
        boleto: {
          expiresDate: "2025-12-31",
          instructions: "Exemplo de Boleto no Sandbox",
          interest: {
            days: 1,
            amount: 159000, // R$ 1.590,00 de juros (verifique se realmente deseja esse valor)
          },
          fine: {
            days: 2,
            amount: 200, // R$ 2,00 de multa
          },
          items: [
            {
              id: "123",
              title: "Produto Exemplo - Boleto",
              quantity: 1,
              unitPrice: 159000, // R$ 1.590,00
            },
          ],
        },
      };

      // Configurações de transação
      // Necessário incluir "customer" para Pix e Boleto
      malgaCheckout.transactionConfig = {
        statementDescriptor: "Malga Checkout Example",
        amount: 159000, // R$ 1.590,00
        description: "Demonstração do Malga Checkout - Sandbox",
        orderId: "pedido-123",
        currency: "BRL",
        capture: false,

        // Exemplo de dados de cliente
        customer: {
          name: "Fulano de Tal",
          email: "fulano@example.com",
          phoneNumber: "+55 11 99999-9999",
          document: {
            type: "CPF",
            number: "12345678901",
            country: "BR",
          },
          address: {
            zipCode: "01001000",
            street: "Av. Exemplo",
            number: "123",
            complement: "Apto 45",
            neighborhood: "Centro",
            city: "São Paulo",
            state: "SP",
            country: "BR",
          },
        },
      };

      // Configurações do diálogo (modal) de status
      malgaCheckout.dialogConfig = {
        show: true,
        actionButtonLabel: "Continuar",
        errorActionButtonLabel: "Tentar novamente",
        successActionButtonLabel: "Continuar",
        successRedirectUrl: "https://www.malga.io/",
        pixFilledProgressBarColor: "#2FAC9B",
        pixEmptyProgressBarColor: "#D8DFF0",
      };

      // Listeners de eventos
      malgaCheckout.addEventListener("paymentSuccess", (event) => {
        console.log("Pagamento concluído com sucesso:", event.detail);
        alert("Pagamento aprovado!");
      });

      malgaCheckout.addEventListener("paymentFailed", (event) => {
        console.log("Falha no pagamento:", event.detail);
        alert("Falha no pagamento! Verifique o console para detalhes.");
      });
    </script>
  </body>
</html>
